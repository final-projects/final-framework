---
title: RequestMapping
layout: page
author: likly
date: 2020-03-22 21:30:09 +800
---

<div id="requestMapping">
    <div class="container-fluid">
        <div class="card">
            <div class="card-header card-header-danger">
                <span class="btn btn-primary" v-html="requestMapping.method"></span>
                <span class="btn btn-lg btn-link text-white font-weight-bold" style="text-transform: none"
                      v-html="requestMapping.pattern"></span>
                <p class="category" v-html="requestMapping.name">Category subtitle</p>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th class="text-center">#</th>
                            <th></th>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Value</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr v-for="(parameter,index) in requestMapping.parameterMappings">
                            <td class="text-center" v-html="index + 1">1</td>
                            <td>
                                <div class="form-check">
                                    <label class="form-check-label">
                                        <input checked="" class="form-check-input" type="checkbox" value="">
                                        <span class="form-check-sign">
                                  <span class="check"></span>
                                </span>
                                    </label>
                                </div>
                            </td>
                            <td v-html="parameter.name">Moleskine Agenda</td>
                            <td>
                                <span class="badge badge-primary" style="text-transform: none"
                                      v-html="parameter.type"></span>
                            </td>
                            <td>
                                <input style="width: 100%" type="text" v-model="parameter.value">
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer text-right">
                <div class=" mr-auto">

                </div>
                <button @click="send" class="btn btn-primary" type="button"><i class="material-icons">send</i>Send
                </button>
            </div>
        </div>
        <!--        Result -->
        <div class="card">
            <div class="card-header"></div>
            <div class="card-body">
                <textarea rows="20" style="width: 100%" v-html="JSON.stringify(result,null,2)"></textarea>
            </div>
        </div>
    </div>
</div>

<script>
    var requestMapping = new Vue({
        el: '#requestMapping',
        data: {
            requestMapping: {},
            result: {}
        },
        mounted: function () {
            this.query();
        },
        methods: {
            query: function () {
                let _this = this;
                let host = 'http://localhost:8080';
                let url = '/api/request/mapping';
                $.http.get({
                    url: host + url,
                    data: {
                        pattern: $.query.string('pattern'),
                        method: $.query.string('method'),
                    },
                    callback: function (result) {
                        if (result.success) {
                            _this.requestMapping = result.data;
                        }
                    }
                });
            },

            send: function () {
                let _this = this;
                let host = 'http://localhost:8080';
                let url = _this.requestMapping.pattern;

                let parameters = {};

                for (let i in _this.requestMapping.parameterMappings) {
                    let parameter = _this.requestMapping.parameterMappings[i];
                    parameters[parameter.name] = parameter.value;
                }


                $.http.send({
                    method: _this.method,
                    url: host + url,
                    data: parameters,
                    callback: function (result) {
                        _this.result = result;
                    }
                })


            }
        }
    });
</script>